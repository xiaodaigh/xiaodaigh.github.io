<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Xiaodaigh.github.io : " />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Xiaodaigh.github.io</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/xiaodaigh">View on GitHub</a>

          <h1 id="project_title">Xiaodaigh.github.io</h1>
          <h2 id="project_tagline"></h2>

        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h3>
<a name="welcome-to-github-pages" class="anchor" href="#welcome-to-github-pages"><span class="octicon octicon-link"></span></a>Welcome to GitHub Pages.</h3>

I looked at some code by others and I made my first Shiny component - shinyhandsontable! It is both an input and output component. So I thought this is not so hard! To give back to the community I have decide to write a tutorial on how to write a component and teach you all the HTML and JavaScript you will need to know to write it.

If you had tried to read the tutorial by RStudio on extending Shiny (http://rstudio.github.io/shiny/tutorial/#building-inputs) and did not fully understand it because it's got too much JavaScript and HTML then this tutorial is for you.

Disclaimer

Please note that I am quite new to JavaScript and HTML, so what I describe here is not guaranteed to be good JavaScript or HTML practice. This tutorial is meant to help you get started with developing Shiny Components and hopefully can spark your interest so that you are motivated to learn more about JavaScript and HTML, develop more components, and benefit the whole Shiny community as a result.

Hopefully if you do learn JavaScript and HTML you will notice what I do as not good practice and feedback to me.

Prerequisites

I have found Shiny to work best in the Chrome browser and this tutorial will be conducted in Chrome. It's best if you install Chrome before you start this tutorial.

Understand

The webpages we see in the web browsers such as Chrome, Firefox and Internet Explorer are all written in HTML (Hypertext Markup Language). You can view the HTML source for the web page by right clicking on somewhere empty and then choosing "View page source".

Run the following code in R

shiny::runExample("01_hello")

and you will see the first Shiny example and right click somewhere empty and select the option View page source will bring up the following HTML source behind the webpage.


First Shiny Example




The HTML source


The source contains the HTML that describes how the page looks initially. I say initially because you can use JavaScript to change the HTML while you are browsing the web page and the browser will display the updated HTML with the changes you made. An example is Gmail's loading of the content without you refreshing the page.

Simplistically speaking HTML is actually static. It presents you with a page with some text and pictures, like this blog. It doesn't really change and it's not interactive. So how does Shiny deliver interactive content? It's achieved through JavaScript.

Essentially Shiny's ui.R file generates the HTML and JavaScript for you. Shiny's server.R uses all the various renderxxx functions to turn your R data into the right HTML for display. As you know you can extend Shiny by writing your own R code that generate the right HTML and JavaScript.

Some Magic with JavaScript

Keep you Shiny Example 1 open, in Chrome press Ctrl + Alt + J to bring up the JavaScript console and type in

$("h1").text("Ni2hao3 Shiny!")

You see what happened? The title changed. This is a bit of magic with JavaScript.

The DOM

When a browser opens up a HTML page it parses the contents, the HTML in the View page source tab, and create a thing call the DOM object. DOM stands for document object model. In a sense the HTML is the DOM object and the DOM object is the HTML in that if you make a change to the DOM the HTML will also change. You can use JavaScript to manipulate the DOM object.

The piece of magic I have shown above is an example of manipulating the DOM, specifically I have changed the text of the title. As soon as you change anything in the DOM object the changes will the reflected in the HTML and your browser will render the HTML correctly to show those differences.

JavaScript like R is interpreted, meaning you can type code into the console and it gets executed right away. In Chrome press Ctrl + Alt + J to open up the JavaScript console as before. Type console.log("Hello world") and you should see that console.log() is the equivalent of print() in R. This is great if you want to try out some functions.

Shiny starts here

I believe this is roughly how Shiny works. It runs the ui.R and generate some HTML based on that. It always puts shiny.js into the HTML.

Type this code into the R console

shiny::headerPanel("Shiny Component Tutorial!")

and you should see a bunch of HTML being generated

Each &lt;something&gt;... &lt;/something&gt;is called an element in HTML and something is called a tag. So 


The ui.R in Shiny is nothing more than a set of R that generates HTML as output. So technically any element you can create in HTML you can create in ui.R

jQuery

Javascript libraries is the equivalent of R packages. One of the most popular Javascript libraries is jQuery. It can help you find (or select in JavaScript/CSS terminology) the right elements in the HTML document and perform actions on them. Why do we need to "select" elements? In R you can assign values and objects to variables names so that you can refer to them later. In HTML there is no concept of variable assign, so if you want to manipulate an element of the DOM you need to "select" it and manipulate it, in HTML you can assign ids to tags or if there are unique features to the tags then you can select it.

The jQuery library has a super-useful function called jQuery. In fact it's so useful that they have given it an alias $. Unlike in R where $ is not allowed as a part of variable name, in JavaScript $ can be used as a part of a valid variable and function name. On the other hand the . (dot) in R is just another character but in JavaScript (and most other languages) it is use to access a property of the object.

If JavaScript was R code then it's like they have done this

jQuery = function(...) { ....some awesome code here... }
$ = jQuery

In R it's common to do plot(object) where the object can be defined by the user and be of classs xyz. The user can define a method called plot.xyz so that when the object is of class xyz calling plot(object) is the same calling plot.xyz(object). In JavaScript it is most likely to be coded as object.plot(). JavaScript can (under some technical requirement) follow R's style as well but it's more typical in JavaScript to do object.plot() type of things. (I personally attend JavaScript workshops that deliberately uses a more functional style of programming, which is more like R)

To make things simpler I have adapted the page from the Hello Shiny example

ui.R
library(shiny)

# Define UI for application that plots random distributions
shinyUI(basicPage(

  # Application title
  headerPanel("Shiny Component Tutorial!"),

  sliderInput("obs",
                "Number of observations:",
                min = 1,
                max = 1000,
                value = 500)
  ,
  # Show a plot of the generated distribution
  plotOutput("distPlot")

))

server.R
library(shiny)

# Define server logic required to generate and plot a random distribution
shinyServer(function(input, output) {

  # Expression that generates a plot of the distribution. The expression
  # is wrapped in a call to renderPlot to indicate that:
  #
  #  1) It is "reactive" and therefore should be automatically
  #     re-executed when inputs change
  #  2) Its output type is a plot
  #
  output$distPlot <- data-blogger-escaped-p="" data-blogger-escaped-renderplot="">
    # generate an rnorm distribution and plot it
    dist <- data-blogger-escaped-input="" data-blogger-escaped-obs="" data-blogger-escaped-p="" data-blogger-escaped-rnorm="">    hist(dist)
  })
})

If you now you do run runGist() you should see an ugly looking app like this. In this example you will learn how to make an input component. How to create a shiny component using handsontable and create the input/output component so that the data being plotted would be printed in a table below the graph.

I think the best way to learn the basic is to actually not use the ui.R and directly go to the HTML. We will come back later show how to write ui.R code, but for now let's copy the source into the www/index.html location. Make sure now you DELETE the ui.R or the app will run by looking into ui.R instead of index.html

Find in HTML the string "distPlot". You will see it in a div tag like this.



Even without knowing too much about HTML I am sure you can already deduce a few things by looking at it, for example I can deduce that it has set the height of the plot ot 400 pixels (height: 400px).

Now let's open up the JavaScript console and change the HTML. First use $ to find the distPlot. The # means to look for the string distPlot in the id = field. It will return the tag with the id = "distPlot". Technically speaking you can write HTML where two different tags have the same ID but you are not meant to do that. I believe the default behaviour of $ is to return only one such id.

 ("#distPlot")
[

&lt;div id=​"distPlot" class=​"shiny-plot-output shiny-bound-output" style=​"width:​ 100% ;​ height:​ 400px"&gt;​…​&lt;/div&gt;​


]

$("#distPlot").addClass("testing-shiny")
[

&lt;div id=​"distPlot" class=​"shiny-plot-output shiny-bound-output testing-shiny" style=​"width:​ 100% ;​ height:​ 400px"&gt;​…​&lt;/div&gt;​


]

You see how the div tag changed? Now class = has a member called testing-shiny. We have added it via our $ function. Of course this is not very useful for our purpose but it does show how JavaScript can change the DOM and the HTML.

I also want to show you how to use external JavaScript libraries and I have chosen handsontable as that's the component I have built. You download all you need from here.

<pre><code>$ cd your_repo_root/repo_name
$ git fetch origin
$ git checkout gh-pages
</code></pre>

<p>If you're using the GitHub for Mac, simply sync your repository and you'll see the new branch.</p>

<h3>
<a name="designer-templates" class="anchor" href="#designer-templates"><span class="octicon octicon-link"></span></a>Designer Templates</h3>

<p>We've crafted some handsome templates for you to use. Go ahead and continue to layouts to browse through them. You can easily go back to edit your page before publishing. After publishing your page, you can revisit the page generator and switch to another theme. Your Page content will be preserved if it remained markdown format.</p>

<h3>
<a name="rather-drive-stick" class="anchor" href="#rather-drive-stick"><span class="octicon octicon-link"></span></a>Rather Drive Stick?</h3>

<p>If you prefer to not use the automatic generator, push a branch named <code>gh-pages</code> to your repository to create a page manually. In addition to supporting regular HTML content, GitHub Pages support Jekyll, a simple, blog aware static site generator written by our own Tom Preston-Werner. Jekyll makes it easy to create site-wide headers and footers without having to copy them across every page. It also offers intelligent blog support and other advanced templating features.</p>

<h3>
<a name="authors-and-contributors" class="anchor" href="#authors-and-contributors"><span class="octicon octicon-link"></span></a>Authors and Contributors</h3>

<p>You can <a href="https://github.com/blog/821" class="user-mention">@mention</a> a GitHub username to generate a link to their profile. The resulting <code>&lt;a&gt;</code> element will link to the contributor's GitHub Profile. For example: In 2007, Chris Wanstrath (<a href="https://github.com/defunkt" class="user-mention">@defunkt</a>), PJ Hyett (<a href="https://github.com/pjhyett" class="user-mention">@pjhyett</a>), and Tom Preston-Werner (<a href="https://github.com/mojombo" class="user-mention">@mojombo</a>) founded GitHub.</p>

<h3>
<a name="support-or-contact" class="anchor" href="#support-or-contact"><span class="octicon octicon-link"></span></a>Support or Contact</h3>

<p>Having trouble with Pages? Check out the documentation at <a href="http://help.github.com/pages">http://help.github.com/pages</a> or contact <a href="mailto:support@github.com">support@github.com</a> and we’ll help you sort it out.</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
